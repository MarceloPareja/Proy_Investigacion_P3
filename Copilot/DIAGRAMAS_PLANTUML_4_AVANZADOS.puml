'=== DIAGRAMA 27: DIAGRAMA DE GANTT - PROYECTO ===
@startuml Gantt_ProjectTimeline
title Plan de Proyecto: Sistema de Conferencias

language es

project starts 2026-02-15

note
  Fases del proyecto con estimaciones
end note

' Fase 1: Setup
[Setup & Infrastructure] starts 2026-02-15 and lasts 2 weeks
[Django Project Setup] starts 2026-02-15 and lasts 10 days
[Database Design] starts 2026-02-15 and lasts 2 weeks
[Infrastructure (Docker/K8s)] starts 2026-02-20 and lasts 1 weeks

' Fase 2: Backend Core
[Paper Module] starts 2026-03-01 and lasts 2 weeks
[Review Module] starts 2026-03-15 and lasts 2 weeks
[Selection Module] starts 2026-03-29 and lasts 2 weeks
[Auth & Security] starts 2026-03-01 and lasts 3 weeks
[Testing] starts 2026-04-12 and lasts 1 weeks

' Fase 3: Frontend
[Portal Autores] starts 2026-03-15 and lasts 3 weeks
[Portal Revisores] starts 2026-04-05 and lasts 3 weeks
[Panel Admin] starts 2026-04-26 and lasts 2 weeks
[Frontend Testing] starts 2026-05-17 and lasts 1 weeks

' Fase 4: Integration
[API Integration] starts 2026-04-12 and lasts 2 weeks  
[E2E Tests] starts 2026-04-26 and lasts 2 weeks
[Performance Tuning] starts 2026-05-10 and lasts 1 weeks

' Fase 5: Deployment
[Staging Deployment] starts 2026-05-24 and lasts 1 weeks
[UAT] starts 2026-05-31 and lasts 2 weeks
[Production Deploy] starts 2026-06-14 and lasts 3 days
[Monitoring & Support] starts 2026-06-17 and lasts ongoing

' Hitos
milestone(m1, "MVP Ready", 2026-05-17, 0d)
milestone(m2, "Production Release", 2026-06-20, 0d)

@enduml


'=== DIAGRAMA 28: TIMING DIAGRAM - AUTORIZACIÓN Y AUTENTICACIÓN ===
@startuml Timing_Auth
title Diagrama de Timing: Autenticación y Autorización

robust "Cliente" as cliente
concise "API Gateway" as gateway
concise "Auth Service" as auth
concise "Session" as session

@0
cliente is idle

@100
cliente -> gateway: POST /login\n(email, password)
gateway is validating

@150
gateway -> auth: validateCredentials()
auth is checking

@200
auth -> session: crear JWT token\ncon expiración 1h
session is storing

@250
auth is valid

@300
gateway is validating
gateway -> cliente: 200 OK\n{token, refresh_token}
cliente is authenticated

@350
cliente -> gateway: GET /papers\nHeader: Authorization: Bearer TOKEN
gateway is processing

@400
gateway -> auth: validateToken()
auth is checking

@450
auth -> session: verificar firma\ny expiración
session is checking

@500
auth is valid
auth <- session: ✓ válido
session is checked

@550
gateway is processing
gateway -> cliente: 200 OK\n{papers}
cliente is active

@600
cliente is active

@700
note right of session : Token expira en 1h

@800
cliente -> gateway: GET /papers\nHeader: Authorization: Bearer EXPIRED_TOKEN
gateway is validating

@850
gateway -> auth: validateToken()
auth is checking

@900
auth -> session: verificar firma
session is checking

@950
session is invalid
auth is invalid

@1000
gateway -> cliente: 401 Unauthorized\n{error: Token expired}
cliente is needs_refresh

@1050
cliente -> gateway: POST /auth/refresh\n(refresh_token)
gateway is processing

@1100
gateway -> auth: refreshToken()
auth is checking

@1150
auth -> session: crear nuevo JWT
session is storing

@1200
auth is valid
gateway -> cliente: 200 OK\n{new_token}
cliente is authenticated

@enduml


'=== DIAGRAMA 29: TIMING DIAGRAM - ENVÍO Y PROCESAMIENTO DE PAPER ===
@startuml Timing_PaperSubmission
title Diagrama de Timing: Envío y Procesamiento de Paper

robust "Autor" as autor
concise "Frontend" as frontend
concise "API Backend" as backend
concise "Queue/Workers" as workers
concise "Email Service" as email

@0
autor is idle

@100
autor -> frontend: Click "Enviar Paper"
frontend is processing

@150
frontend -> frontend: Valida campos\nen cliente
frontend is validating

@200
frontend is valid

@250
frontend -> backend: POST /papers\n(file, metadata)
backend is receiving

@300
backend -> backend: Validar token JWT
backend is validating

@350
backend is authenticated

@400
backend -> backend: Validar formato archivo
backend is validating

@450
backend -> backend: Guardar en BD
backend is saving

@500
backend is saved

@550
backend -> workers: Queue: onPaperSubmitted\nevent
workers is queued

@600
backend -> frontend: 201 Created\n{id: 123}
frontend is complete

@650
frontend -> autor: ✓ Paper enviado!
autor is notified

@700
workers -> workers: Procesar evento
workers is processing

@750
workers -> email: Enviar confirmación\na autor
email is sending

@800
email is sent

@850
workers -> workers: Indexar en búsqueda
workers is indexing

@900
workers is done

@950
note right of backend: Procesamiento asincrónico\nno bloquea usuario

@enduml


'=== DIAGRAMA 30: FLUJO DE PRIORIDADES Y COLAS ===
@startuml Activity_QueuePriorities
title Gestión de Colas: Prioridades

start

:Evento generado;

if (¿Tipo de evento?) then (Critical)
    :Priority = 1\n(crítico);
    note right: Notificaciones inmediatas\nErrores del sistema
    end note
else if (High)
    :Priority = 2\n(alto);
    note right: Notificaciones de resultados\nRecordatorios deadline
    end note
else if (Medium)
    :Priority = 3\n(medio);
    note right: Emails de información\nReportes
    end note
else (Low)
    :Priority = 4\n(bajo);
    note right: Tareas administrativas\nBackups
    end note
endif

:Agregar a queue\ncon prioridad;

:Worker recoge del queue\nde mayor a menor prioridad;

:Procesar en orden;

stop

@enduml


'=== DIAGRAMA 31: ROADMAP DE CARACTERÍSTICAS ===
@startuml Roadmap_Features
title Roadmap de Características: Fases 1-4

package "Phase 1: MVP\n(v1.0)" {
    frame MVP {
        component [Envío de Papers]
        component [Asignación de Revisores]
        component [Evaluación de Papers]
        component [Selección Final]
        component [Notificaciones Básicas]
    }
}

package "Phase 2: Mejoras\n(v1.1-1.2)" {
    frame Improvements {
        component [Admin Panel Avanzado]
        component [Reportes y Estadísticas]
        component [API Pública]
        component [Búsqueda Avanzada]
        component [Integración ORCID]
    }
}

package "Phase 3: Escalabilidad\n(v2.0)" {
    frame Scalability {
        component [Multi-Idioma]
        component [Múltiples Conferencias]
        component [Integración con LMS]
        component [Mobile App]
        component [Análisis ML]
    }
}

package "Phase 4: Futuro\n(v2.1+)" {
    frame Future {
        component [Blockchain para Auditoría]
        component [AI-Powered Matching]
        component [Live Streaming Integration]
        component [Paper Recommendations]
        component [Community Features]
    }
}

@enduml


'=== DIAGRAMA 32: RIESGOS Y MITIGACIÓN ===
@startuml Activity_RiskMitigation
title Gestión de Riesgos

start

:Identificar Riesgos;

partition "Riesgos Técnicos" {
    :R1: Performance bajo carga;
    note right: Impact: Alto | Probability: Media
    end note
    :Mitigación: Load testing, caching, CDN;
    
    :R2: Pérdida de datos;
    note right: Impact: Crítico | Probability: Baja
    end note
    :Mitigación: Backups, replicación, recovery plan;
}

partition "Riesgos de Seguridad" {
    :R3: Breach de datos;
    note right: Impact: Crítico | Probability: Baja
    end note
    :Mitigación: Encryption, auditoría, 2FA;
    
    :R4: Vulnerabilidades\nde software;
    note right: Impact: Alto | Probability: Media
    end note
    :Mitigación: Code review, testing, updates;
}

partition "Riesgos de Negocio" {
    :R5: Baja adopción;
    note right: Impact: Medio | Probability: Media
    end note
    :Mitigación: UX testing, capacitación;
    
    :R6: Delay en deadline;
    note right: Impact: Medio | Probability: Alta
    end note
    :Mitigación: Buffer time, recursos adicionales;
}

:Monitoreo continuo;

stop

@enduml


'=== DIAGRAMA 33: ARQUITECTURA DE CACHÉ ===
@startuml Architecture_Caching
title Estrategia de Caché Multinivel

package "Client-Side Caching" {
    component BrowserCache [
        **Browser Cache**
        ----
        Cache-Control headers
        ETag validation
        Tiempo: 1-7 días
    ]
    component AppCache [
        **App Memory Cache**
        ----
        Redux/Vuex store
        LocalStorage
        Tiempo: Sesión
    ]
}

package "Network Caching" {
    component CDN [
        **CDN (CloudFlare)**
        ----
        Static assets
        Tiempo: 30 días
    ]
}

package "Server-Side Caching" {
    component RedisCache [
        **Redis Cache Layer**
        ----
        Active: Sessions
        Papers: 1 hora
        Reviews: 30 min
        Usuarios: 1 hora
        Estadísticas: 2 horas
    ]
    component DBCache [
        **Database Query Cache**
        ----
        ORM caching
        Query optimization
    ]
}

component User [Usuario]
component API [API Backend]
component DB [PostgreSQL]

User --> BrowserCache
User --> AppCache
BrowserCache --> CDN
AppCache --> API
API --> RedisCache
RedisCache --> DB
API --> DB

@enduml


'=== DIAGRAMA 34: MONITOREO Y ALERTAS ===
@startuml Activity_Monitoring
title Sistema de Monitoreo y Alertas

start

:Prometheus scrape metrics\ncada 30 segundos;

:Recolectar métricas;
note right
- Response time
- Error rate
- CPU usage
- Memory
- QPS
- Active connections
end note

:Pasando a Grafana;

:Graficar dashboards;

if (¿Métrica > threshold?) then (Sí)
    :Generar alerta;
    
    if (¿Severidad?) then (Critical)
        :Enviar SMS\nSendar email\nSlack message;
    else if (Warning)
        :Enviar email\nSlack message;
    else (Info)
        :Enviar Slack message;
    endif
    
    :Crear ticket/incident;
    
    :On-call engineer\nrecibe notificación;
    
    :Investigar y resolver;
    
else (No)
    :Todo normal;
endif

:Guardar histórico;

:Crear reporte\nde SLA;

stop

@enduml


'=== DIAGRAMA 35: ESTRATEGIA DE TESTING ===
@startuml TestingStrategy
title Estrategia de Testing: Pirámide

rectangle "E2E Tests\n10%\n(Selenium, Cypress)" as e2e
rectangle "Integration Tests\n30%\n(API testing, DB testing)" as integration
rectangle "Unit Tests\n60%\n(Jest, Pytest)" as unit

unit -up-> integration
integration -up-> e2e

note bottom of unit
Rápidos, locales
Coverage: >80%
end note

note bottom of integration
Más lentamente
Coverage: >70%
end note

note bottom of e2e
Más lentos, UI completa
Coverage: happy path
end note

@enduml


'=== DIAGRAMA 36: ESTRATEGIA DE DESPLIEGUE (BLUE-GREEN) ===
@startuml Deployment_BlueGreen
title Estrategia de Despliegue: Blue-Green Deployment

package "Producción" {
    component BlueEnv [
        **Blue Environment**
        (Versión Actual)
        ----
        API v1.0.0
        BD v1.0
        Usuarios en uso
    ]
    
    component GreenEnv [
        **Green Environment**
        (Nueva Versión)
        ----
        API v1.1.0
        BD v1.1
        Vacío / Testing
    ]
    
    component LoadBalancer [
        **Load Balancer**
        ----
        100% → Blue
        0% → Green
    ]
}

package "Proceso de Deploy" {
    component Step1 [ 1. Desplegar en Green ]
    component Step2 [ 2. Smoke tests en Green ]
    component Step3 [ 3. Cambiar routing\nBlue ← → Green ]
    component Step4 [ 4. Monitoreo ]
    component Step5 [ 5. Rollback o cleanup ]
}

LoadBalancer --> BlueEnv
LoadBalancer --> GreenEnv

Step1 --> Step2
Step2 --> Step3
Step3 --> Step4
Step4 --> Step5

@enduml
